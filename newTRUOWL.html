<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>T.R.U. OWL Score Viewer</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet" />
  <style>
  :root {
    --navy: #1A1A40;
    --text: #F5F5F5;
    --accent-blue: #3B6CED;
    --hover: #4FDBA6;
    --border: #2F2F5F;
  }

  body {
    background-color: var(--navy);
    font-family: 'Inter', sans-serif;
    color: var(--text);
    margin: 0;
    padding: 0;
  }

  h1, h2, h3 {
    font-family: 'Playfair Display', serif;
  }

  .content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 40px 20px;
  }

  .welcome-heading {
    font-size: 2.2rem;
    text-align: center;
    margin-top: 60px;
    margin-bottom: 30px;
    font-weight: bold;
  }

  .divider-bar {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin: 30px auto;
  }

  .divider-bar div {
    width: 40px;
    height: 6px;
    border-radius: 3px;
  }

  .truth { background-color: #4CAF50; }
  .reliability { background-color: #2196F3; }
  .understanding { background-color: #FFD700; }

  .text-truth { color: #4CAF50; font-weight: bold; }
  .text-reliability { color: #2196F3; font-weight: bold; }
  .text-understanding { color: #FFD700; font-weight: bold; }

  .section-box {
    background-color: #2F2E5E;
    padding: 40px;
    border-radius: 12px;
    box-shadow: 0 0 12px rgba(0, 0, 0, 0.5);
    margin: 30px auto 60px;
    max-width: 900px;
  }

  select {
    background-color: #1A1A40;
    color: var(--text);
    border: 1px solid var(--border);
    padding: 12px;
    font-size: 1rem;
    width: 100%;
    margin-top: 20px;
    margin-bottom: 30px;
    border-radius: 6px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    font-size: 0.95rem;
  }

  th, td {
    border: 1px solid #3B6CED;
    padding: 12px;
    text-align: left;
  }

  th {
    background-color: #2F2E5E;
  }

  td {
    background-color: #1A1A40;
  }

  strong {
    color: #FFEB3B;
  }

  /* ✅ Responsive, Centered Role Grid */
  .score-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    place-items: start center;
    gap: 32px;
    margin: 40px auto 60px;
    max-width: 1100px;
    padding: 0 10px;
  }

  .role-box {
    background-color: #1A1A40;
    padding: 20px;
    border-radius: 12px;
    border: 1px solid var(--border);
    box-shadow: 0 0 12px rgba(0, 0, 0, 0.4);
  }

  .role-box p {
    margin: 4px 0;
    font-size: 0.95rem;
  }

  .role-box small {
    display: block;
    font-size: 0.85rem;
    color: #C0C0C0;
    margin-top: 8px;
  }

  .category-heading {
    font-size: 1.2rem;
    border-bottom: 2px solid var(--accent-blue);
    padding-bottom: 6px;
    margin-bottom: 14px;
  }

  /* ✅ Total Score Section */
  .total-score-box {
    background-color: #2F2E5E;
    color: var(--text);
    border: 1px solid var(--border);
    padding: 24px;
    border-radius: 12px;
    max-width: 800px;
    margin: 20px auto 60px;
    text-align: center;
    box-shadow: 0 0 12px rgba(0, 0, 0, 0.4);
  }

  .total-score-box h3 {
    font-size: 1.4rem;
    margin-bottom: 12px;
    color: var(--accent-blue);
    font-family: 'Playfair Display', serif;
  }

  .total-score-box p {
    font-size: 1rem;
    line-height: 1.6;
    color: #DDDDDD;
  }

  /* ✅ Mobile Optimization */
  @media (max-width: 600px) {
    .score-grid {
      grid-template-columns: 1fr !important;
      padding: 0 12px;
    }

    .role-box {
      margin: 0 auto;
      width: 100%;
    }

    .welcome-heading {
      font-size: 1.6rem;
    }

    .content {
      padding: 30px 15px;
    }

    .total-score-box {
      padding: 20px;
      margin: 20px 12px 40px;
    }

    .total-score-box h3 {
      font-size: 1.2rem;
    }

    .total-score-box p {
      font-size: 0.95rem;
    }
  }
</style>
</head>
<body>
  <div class="content">
    <h1 class="welcome-heading">Welcome to the T.R.U. OWL Score</h1>
    <div class="divider-bar">
      <div class="truth"></div>
      <div class="reliability"></div>
      <div class="understanding"></div>
    </div>

    <div class="section-box">
      <p><strong>This isn’t a media bias site. It’s a truth system.</strong></p>
      <p>The T.R.U. OWL Score is a credibility framework that measures public figures based on <span class="text-truth">verifiable truth</span> — not vibes, tribes, or talking points.</p>
      <p>We don’t ask what side someone’s on. We ask: <em>Did they tell the truth?</em> Did they correct themselves when wrong? Are they consistent? Do they understand what they’re talking about?</p>
      <p>Through <strong>court records</strong>, <strong>public data</strong>, and <strong>source-backed analysis</strong>, we track what can be proven — and score it across three pillars:</p>
      <ul>
        <li><span class="text-truth">Truth</span> – Are the claims factually accurate?</li>
        <li><span class="text-reliability">Reliability:</span> – Are they consistent and accountable?</li>
        <li><span class="text-understanding">Understanding:</span> – Do they grasp the systems they discuss?</li>
      </ul>
      <p>Each role is measured differently — because journalists aren’t lawmakers, and influencers aren’t investigators. But all are held to <strong>real standards</strong>.</p>
      <p><strong>This is about course-correction — not cancellation.</strong> We reward accuracy, transparency, and integrity. We expose distortion, evasion, and disinformation.</p>
      <p><strong>Why this matters:</strong> In a world where influence often outruns accountability, the T.R.U. OWL Score changes the incentive structure. It rewards those who elevate truth — and reveals those who erode it.</p>
      <p><span class="text-truth">Truth</span> isn't a matter of opinion — it’s a record. And now, for the first time, you can see it clearly, compare it publicly, and use it strategically.</p>
      <p>This system exists not to play favorites, but to make <strong>credibility visible</strong> — so that public trust can be earned, not assumed. When <span class="text-truth">truth</span> becomes visible, <span class="text-reliability">accountability</span> follows — and that’s how we move forward.</p>

      <label for="person-select"><strong>Select a public figure:</strong></label>
      <select id="person-select"></select>

      <table id="score-table" style="display: none;">
        <thead>
          <tr>
            <th>Category</th>
            <th>Score</th>
            <th>Comment</th>
          </tr>
        </thead>
        <tbody id="score-body"></tbody>
      </table>
    </div>
<!-- ✅ Updated Weighted Role Grid (fixed layout to match the horizontal cards view) -->
<div class="score-grid">
  <div class="role-box">
    <h3 class="category-heading">President</h3>
    <p><span class="text-truth">Truth:</span> 4.0×</p>
    <p><span class="text-reliability">Reliability:</span> 4.0×</p>
    <p><span class="text-understanding">Understanding:</span> 5.0×</p>
    <small>The highest office holds the highest responsibility. Their words move the world.</small>
  </div>
  <div class="role-box">
    <h3 class="category-heading">Executive</h3>
    <p><span class="text-truth">Truth:</span> 3.5×</p>
    <p><span class="text-reliability">Reliability:</span> 3.5×</p>
    <p><span class="text-understanding">Understanding:</span> 4.5×</p>
    <small>Includes VP, Cabinet-level leaders, and Justices. Their decisions shape national systems.</small>
  </div>
  <div class="role-box">
    <h3 class="category-heading">Politicians</h3>
    <p><span class="text-truth">Truth:</span> 3.0×</p>
    <p><span class="text-reliability">Reliability:</span> 3.0×</p>
    <p><span class="text-understanding">Understanding:</span> 4.0×</p>
    <small>Elected voices must be held to the laws they create and the oaths they swear.</small>
  </div>
  <div class="role-box">
    <h3 class="category-heading">Journalists</h3>
    <p><span class="text-truth">Truth:</span> 3.0×</p>
    <p><span class="text-reliability">Reliability:</span> 3.0×</p>
    <p><span class="text-understanding">Understanding:</span> 4.0×</p>
    <small>Responsible for informing the public. Corrections, context, and clarity are essential.</small>
  </div>
  <div class="role-box">
    <h3 class="category-heading">Influencers</h3>
    <p><span class="text-truth">Truth:</span> 1.3×</p>
    <p><span class="text-reliability">Reliability:</span> 1.3×</p>
    <p><span class="text-understanding">Understanding:</span> 2.0×</p>
    <small>They shape minds without formal power. Trust is earned by how truthfully they speak.</small>
  </div>
</div>

<!-- ✅ Transparency Note -->
<p style="text-align: center; font-size: 0.9rem; color: #C0C0C0; margin-top: -10px;">
  <em>Note:</em> The T.R.U. OWL Score focuses on public figures with influence. This is not a social credit system, and private individuals are not evaluated.
</p>

<!-- ✅ Divider after the grid -->
<div class="divider-bar">
  <div class="truth"></div>
  <div class="reliability"></div>
  <div class="understanding"></div>
</div>

  <!-- Include your scoring script here -->
  <script>
  const TRU_MULTIPLIERS = {
    5: { truth: 4.0, reliability: 4.0, understanding: 5.0 },
    4: { truth: 3.5, reliability: 3.5, understanding: 4.5 },
    3: { truth: 3.0, reliability: 3.0, understanding: 4.0 },
    2: { truth: 3.0, reliability: 3.0, understanding: 4.0 },
    1: { truth: 1.3, reliability: 1.3, understanding: 2.0 },
    0: { truth: 1.0, reliability: 1.0, understanding: 2.0 },
  };

  async function fetchTRUData() {
    const API_KEY = "AIzaSyCzuh9HBfe0r70r9U35Pe406PPZ-tz6I78";
    const SHEET_ID = "19wBEj9hEkvIyQcoR5E_mBGVAxTzMnddMxk8nuQLAumA";
    const RANGE = "TRU!A2:AG1000";

    const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}?key=${API_KEY}`;
    try {
      const res = await fetch(url);
      if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
      const json = await res.json();
      return json.values || [];
    } catch (err) {
      console.error("Failed to fetch sheet data", err);
      const select = document.getElementById("person-select");
      if (select) {
        select.innerHTML = '<option value="">Failed to load data.</option>';
      }
      return [];
    }
  }

  window.showScores = function () {
    const select = document.getElementById("person-select");
    const table = document.getElementById("score-table");
    const tbody = document.getElementById("score-body");
    const totalBox = document.getElementById("total-score-box");
    const totalCommentEl = document.getElementById("total-score-comment");

    const selected = select.value;
    if (!selected || !window.rowMap || !window.rowMap[selected]) {
      table.style.display = "none";
      if (totalBox) totalBox.style.display = "none";
      return;
    }

    const row = window.rowMap[selected];
    tbody.innerHTML = "";

    const truthRaw = parseFloat(row[25]) || 0;
    const reliabilityRaw = parseFloat(row[26]) || 0;
    const understandingRaw = parseFloat(row[27]) || 0;

    const commentTruth = row[28] || "";
    const commentReliability = row[29] || "";
    const commentUnderstanding = row[30] || "";
    const totalScoreComment = row[31] || "Summary not available";

    const roleFlag = parseInt(row[32]) || 0;
    const multiplier = TRU_MULTIPLIERS[roleFlag] || TRU_MULTIPLIERS[0];

    const truthFinal = truthRaw * multiplier.truth;
    const reliabilityFinal = reliabilityRaw * multiplier.reliability;
    const understandingFinal = understandingRaw * multiplier.understanding;

    const scores = [
      {
        label: "Truth",
        value: truthFinal,
        raw: truthRaw,
        mult: multiplier.truth,
        comment: commentTruth,
      },
      {
        label: "Reliability",
        value: reliabilityFinal,
        raw: reliabilityRaw,
        mult: multiplier.reliability,
        comment: commentReliability,
      },
      {
        label: "Understanding",
        value: understandingFinal,
        raw: understandingRaw,
        mult: multiplier.understanding,
        comment: commentUnderstanding,
      },
    ];

    let total = 0;

    scores.forEach(({ label, value, raw, mult, comment }) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${label}</td>
        <td>${value >= 0 ? "+" : ""}${value.toFixed(0)} <small>(${raw.toFixed(1)} × ${mult.toFixed(1)})</small></td>
        <td>${comment}</td>`;
      tbody.appendChild(tr);
      total += value;
    });

    const totalRow = document.createElement("tr");
    totalRow.innerHTML = `
      <td><strong>Total Score</strong></td>
      <td><strong>${total >= 0 ? "+" : ""}${total.toFixed(0)}</strong></td>
      <td><strong>${totalScoreComment}</strong></td>`;
    tbody.appendChild(totalRow);

    table.style.display = "table";

    if (totalBox && totalCommentEl) {
      totalCommentEl.textContent = totalScoreComment;
      totalBox.style.display = "block";
    }
  };

  window.initTRUOWLPage = async function () {
    window.rowMap = {};
    const data = await fetchTRUData();
    data.forEach(row => {
      const key = row[0];
      if (key) window.rowMap[key] = row;
    });

    const select = document.getElementById("person-select");
    if (!select) {
      console.warn("[TRU OWL] Dropdown not found.");
      return;
    }

    select.innerHTML = '<option value="">-- Choose a name --</option>';
    Object.keys(window.rowMap).sort().forEach(name => {
      const opt = document.createElement("option");
      opt.value = name;
      opt.textContent = name.replace(/([A-Z])/g, " $1").replace(/^./, s => s.toUpperCase());
      select.appendChild(opt);
    });

    select.removeEventListener("change", window.showScores);
    select.addEventListener("change", window.showScores);
  };

  // ❌ Removed: window.onload
  // ✅ Trigger this with initPageScripts() in SPA loader (e.g., test.html)
</script>
</body>
</html>
