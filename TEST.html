<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Strategic Owl | The Constitution</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet" />

  <style>
  :root {
    --background: #0D1B2A;
    --surface: #112240;
    --highlight: #1A2B4C;
    --truth: #28A745;
    --reliability: #3B6CED;
    --understanding: #D4AF37;
    --text: #FFFFFF;
    --text-muted: #7C8A9B;
    --heading: #FFFFF0;
    --shadow: rgba(0, 0, 0, 0.3);
    --bar-red: #FF4C4C;
    --bar-green: #28A745;
  }

  body {
    background-color: var(--background);
    color: var(--text);
    font-family: 'Inter', sans-serif;
    margin: 0;
    padding: 0;
  }

  /* 🧭 NAVBAR & MENU */
  nav.top-nav {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 999;
    background-color: var(--highlight);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px 20px;  /* 🟡 Controls vertical height of navbar */
    box-shadow: 0 2px 6px var(--shadow);
  }

  .nav-title {
    font-family: 'Playfair Display', serif;
    font-size: 22px;
    color: var(--understanding);
  }

  .menu-toggle {
    display: none;
    font-size: 24px;
    cursor: pointer;
    color: var(--text);
    background: none;
    border: none;
  }

  .nav-links {
    display: flex;
    gap: 28px;
  }

  .nav-links a {
    color: var(--text-muted);
    text-decoration: none;
    font-size: 15px;
    transition: color 0.3s ease;
  }

  .nav-links a:hover {
    color: var(--understanding);
  }
    .nav-logo img {
  height: 40px;
  width: 40px;
}
    .nav-logo {
  display: flex;
  align-items: center;
  gap: 10px;
  text-decoration: none;
  font-weight: 600;
  color: var(--text);
  font-size: 1.25rem;
}
    /* 🎨 TRU Bars */
  .divider-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 40px auto; /* 🟡 Adjust this to reduce space around the TRU bar (try 24px auto or 24px auto 12px) */
  }

  .divider-bar {
    display: flex;
    gap: 12px;
    width: 340px;
  }

  .divider-bar div {
    width: 108px;
    height: 6px;
    border-radius: 3px;
    box-shadow: 0 0 4px var(--shadow);
  }

  .truth { background-color: var(--truth); }
  .reliability { background-color: var(--reliability); }
  .understanding { background-color: var(--understanding); }

  .divider-labels {
    display: flex;
    justify-content: center;
    gap: 12px;
    width: 340px;
    margin-top: 8px;/* 🟡 Adjust this to pull labels closer to bars (try 4px if needed) */
  }

  .divider-labels span {
    width: 108px;
    text-align: center;
    font-size: 0.85rem;
    color: var(--text-muted);
  }

  @media (max-width: 768px) {
    .menu-toggle {
      display: block;
    }

    .nav-links {
      display: none;
      flex-direction: column;
      align-items: center;/* 👈 links side-by-side on mobile */
      justify-content: center;
      background-color: var(--highlight);
      position: absolute;
      top: 58px;
      left: 0;
      width: 100%;
      padding: 10px 0;
      gap: 20px;
      box-shadow: 0 3px 8px var(--shadow);
    }
    .nav-links a {
  padding: 10px 0;
  width: 100%;
  text-align: center;
  font-size: 1rem;
}

    .nav-links.show {
      display: flex;
      animation: fadeSlideDown 0.3s ease;
    }

    @keyframes fadeSlideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  }
    @media (max-width: 500px) {
  #legal-popup > div {
    padding: 12px;
    font-size: 0.95rem;
  }
      @media (max-width: 500px) {
  .container {
    padding: 16px;
    margin-top: 48px; /* Tighten space for mobile */
  }

  h1, h2 {
    font-size: 1.25rem;
    margin-bottom: 10px;
  }

  p {
    font-size: 0.9rem;
    margin-bottom: 14px;
  }

  .divider-section {
    margin: 24px auto 8px auto; /* Pull TRU bars closer */
  }

  .divider-bar {
    width: 280px;
    gap: 8px;
  }

  .divider-bar div {
    width: 84px;
  }

  .divider-labels {
    width: 280px;
    gap: 8px;
    margin-top: 6px;
  }

  .divider-labels span {
    width: 84px;
    font-size: 0.75rem;
  }

  .owl-button {
    padding: 8px 14px;
    font-size: 0.95rem;
  }
}

  #accept-btn {
    width: 100%;
    font-size: 1rem;
  }

  p {
    font-size: 0.95rem;
    margin-bottom: 16px;/* 🟡 Mobile-specific paragraph margin */
  }
}

  /* ✅ YOUR ORIGINAL STYLES BELOW */
  .container {
    max-width: 960px;
    margin: 72px auto 0 auto; /* 🟡 Adjust this top margin to tighten space below nav (try 72px or 60px) */
    padding: 24px;
  }

  h1 {
    font-family: 'Playfair Display', serif;
    color: var(--heading);
    margin-bottom: 16px;
    text-align: center;
  }
  h2 {
  font-family: 'Playfair Display', serif;
  font-size: 1.5rem;
  color: var(--understanding); /* golden highlight */
  font-weight: 600;
  margin-top: 4px; /* 🟡 Reduce this if h2 spacing feels too large (try 12px–20px) */
  margin-bottom: 12px;
  text-align: center;
}
  p {
  font-family: 'Inter', sans-serif;
  font-size: 1.05rem;
  color: var(--text-muted);
  line-height: 1.6;
  margin-bottom: 20px; /* 🟡 You can tighten this to 12px or 16px for stacked content */
  text-align: center;
  max-width: 700px;
  margin-left: auto;
  margin-right: auto;
}

  select {
    padding: 8px;
    margin-bottom: 16px;
    background-color: var(--surface);
    color: var(--text);
    border: 1px solid var(--highlight);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    background-color: var(--surface);
    margin-top: 12px;
  }

  th, td {
    padding: 12px;
    border-bottom: 1px solid var(--highlight);
    text-align: left;
  }

  .text-truth { color: var(--truth); }
  .text-reliability { color: var(--reliability); }
  .text-understanding { color: var(--understanding); }

  .total-score {
    font-weight: bold;
  }

  .positive-score { color: var(--bar-green); }
  .negative-score { color: var(--bar-red); }

  .score-bar {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .bar-indicator {
    width: 10px;
    height: 24px;
    border-radius: 2px;
  }

  .bar-red {
    background-color: var(--bar-red);
  }

  .bar-green {
    background-color: var(--bar-green);
  }
    .match-nav-link {
  color: var(--text-muted);
  text-decoration: none;
  font-size: 15px;
  transition: color 0.3s ease;
}

.match-nav-link:hover {
  color: var(--understanding);
}
 /* 🦉 Strategic Owl Button Style */
.owl-button {
  background-color: var(--navy);            /* Deep base color */
  color: white;                             /* Clean readable text */
  font-weight: 600;                         /* Medium-bold */
  padding: 10px 18px;
  border: 1px solid var(--reliability);     /* Outline in reliability yellow */
  border-radius: 8px;
  font-family: 'Inter', sans-serif;
  font-size: 1rem;
  cursor: pointer;
  text-decoration: none;
  transition: 
    background-color 0.3s ease, 
    color 0.3s ease,
    box-shadow 0.3s ease;
}

.owl-button:hover {
  background-color: var(--reliability);     /* Hover color = yellow */
  color: var(--navy);                       /* Invert text color */
  box-shadow: 0 0 12px var(--reliability);  /* Glow on hover */
}
    .owl-slider {
  -webkit-appearance: none;
  width: 100%;
  height: 8px;
  background: var(--highlight);
  border-radius: 5px;
  outline: none;
}

.owl-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 22px;
  height: 22px;
  border-radius: 50%;
  background: var(--understanding);
  cursor: pointer;
  border: 2px solid var(--navy);
}

.owl-slider::-moz-range-thumb {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  background: var(--understanding);
  cursor: pointer;
  border: 2px solid var(--navy);
}
    #quiz-scale::-webkit-scrollbar {
  height: 6px;
}
#quiz-scale::-webkit-scrollbar-thumb {
  background: var(--highlight);
  border-radius: 4px;
}
    .scale-buttons {
    display: flex;
    justify-content: center;
    gap: 6px;
    flex-wrap: wrap;
    margin: 20px 0;
  }
  .scale-btn {
    background-color: var(--highlight);
    color: var(--text);
    border: 1px solid var(--understanding);
    border-radius: 6px;
    padding: 8px 12px;
    font-family: 'Inter', sans-serif;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }
  .scale-btn:hover,
  .scale-btn.selected {
    background-color: var(--understanding);
    color: var(--navy);
  }
  #slider-value {
    text-align: center;
    margin-top: 10px;
    color: var(--text-muted);
    font-size: 1rem;
  }
</style>

<nav class="top-nav">
<a href="TRUOWL3.html" class="nav-logo">
  <img src="owl_logo_white.png" alt="Owl Logo" onerror="this.style.display='none';" />
  <div class="nav-title">The Strategic Owl</div>
</a>
  <button class="menu-toggle" onclick="toggleMenu()">☰</button>
  <div class="nav-links" id="navMenu">
   <a href="Index.html">Home</a>
    <a href="TRUOWL3.html">T.R.U. Owl</a>
    <a href="newelections3.html">Election Security</a>
    <a href="the_constitution.html">The Constitution</a>
    <a href="newcontact3.html">Contact</a>
  </div>
</nav>
  <div class="container">
    <h1>Strategic Grounding</h1>
<!-- 🎯 Divider -->
    <section class="divider-section">
      <div class="divider-bar">
        <div class="truth"></div>
        <div class="reliability"></div>
        <div class="understanding"></div>
      </div>
      <div class="divider-labels">
        <span>Truth</span>
        <span>Reliability</span>
        <span>Understanding</span>
      </div>
    </section>
 <!-- 🦉 Strategic Owl Radicalization Quiz -->
<div id="quiz-container" class="container">
  <h2 style="text-align: center; color: var(--understanding); font-family: 'Playfair Display', serif;">
    How Strategically Grounded Are You?
  </h2>

  <p style="text-align: center; max-width: 700px; margin: 0 auto 16px; color: var(--text-muted); font-family: 'Inter', sans-serif; font-size: 1rem;">
    This interactive tool helps assess your civic positioning — not your politics. It’s completely anonymous and your answers are stored nowhere.
  </p>

  <p style="text-align: center; max-width: 700px; margin: 0 auto 30px; color: var(--text-muted); font-family: 'Inter', sans-serif; font-size: 1rem;">
    Don’t overthink it. Clear your mind and respond authentically. The goal is reflection, not performance.
  </p>

  <div id="quiz-question" style="margin-top: 40px; text-align: center;"></div>

  <div id="quiz-scale" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin: 20px 0;"></div>

  <!-- Inline narrative response area -->
  <div id="narrative-display" style="max-width: 600px; margin: 0 auto; padding: 20px; display: none; background-color: var(--surface); color: var(--text); border-left: 4px solid var(--reliability); border-radius: 8px; font-size: 1rem; font-family: 'Inter', sans-serif;"></div>

  <!-- "Next" button shown AFTER delay -->
  <button id="next-question" style="
    display: none;
    margin: 20px auto 0;
    background-color: var(--reliability);
    color: white;
    padding: 10px 24px;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-family: 'Montserrat', sans-serif;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.3s ease;
  ">
    Next Question →
  </button>

  <div id="quiz-result" style="margin-top: 40px;"></div>
</div>

<script>
const SHEET_ID = "19wBEj9hEkvIyQcoR5E_mBGVAxTzMnddMxk8nuQLAumA";
const API_KEY = "AIzaSyCzuh9HBfe0r70r9U35Pe406PPZ-tz6I78";

const QUIZ_RANGE = "TRUTest!C3:S100";
const INSIGHT_RANGE = "Insights!A2:A12";

let quizData = [];
let insightMessages = [];
let currentIndex = 0;
let userScores = [];

async function fetchTRUData() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${QUIZ_RANGE}?key=${API_KEY}`;
  const res = await fetch(url);
  const json = await res.json();
  return json.values;
}

async function fetchInsightMessages() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${INSIGHT_RANGE}?key=${API_KEY}`;
  const res = await fetch(url);
  const json = await res.json();
  return json.values.flat();
}

function renderInput(container, flipLogic, weight, highNarr, moderateNarr, lowNarr, question) {
  const scale = document.getElementById("quiz-scale");
  const narrativeBox = document.getElementById("narrative-display");
  const nextBtn = document.getElementById("next-question");
  let selected = false;

  scale.innerHTML = "";

  const isMobile = window.innerWidth <= 768;

  if (isMobile) {
    const sliderInput = document.createElement("input");
    sliderInput.type = "range";
    sliderInput.min = 0;
    sliderInput.max = 10;
    sliderInput.step = 1;
    sliderInput.value = 5;
    sliderInput.className = "owl-slider";
    sliderInput.style.margin = "20px auto";
    sliderInput.style.display = "block";
    sliderInput.style.maxWidth = "500px";
    sliderInput.style.width = "100%";

    const valueDisplay = document.createElement("div");
    valueDisplay.id = "slider-value";
    valueDisplay.innerText = `Selected: 5`;

    sliderInput.oninput = (e) => {
      const i = parseInt(e.target.value);
      valueDisplay.innerText = `Selected: ${i}`;
      const adjusted = flipLogic ? i : 10 - i;
      let narrative = moderateNarr;
      if (adjusted <= 3) narrative = lowNarr;
      else if (adjusted >= 8) narrative = highNarr;

      userScores[currentIndex] = {
        score: adjusted,
        weight: parseFloat(weight),
        originalInput: i,
        question: question
      };

      narrativeBox.innerHTML = `<p style='margin-top: 20px;'>${narrative}</p>`;
      narrativeBox.style.display = "block";

      if (!selected) {
        selected = true;
        setTimeout(() => {
          nextBtn.style.display = "block";
          nextBtn.textContent = (currentIndex === quizData.length - 1) ? "Show Results" : "Next Question →";
        }, 1500);

        nextBtn.onclick = () => {
          narrativeBox.style.display = "none";
          nextBtn.style.display = "none";
          currentIndex++;
          if (currentIndex < quizData.length) loadQuestion(currentIndex);
          else showFinalResult();
        };
      }
    };

    scale.appendChild(valueDisplay);
    scale.appendChild(sliderInput);

  } else {
    const buttonWrapper = document.createElement("div");
    buttonWrapper.className = "scale-buttons";
    for (let i = 0; i <= 10; i++) {
      const btn = document.createElement("button");
      btn.innerText = i;
      btn.className = "scale-btn";
      btn.onclick = () => {
        document.querySelectorAll('.scale-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        const adjusted = flipLogic ? i : 10 - i;
        let narrative = moderateNarr;
        if (adjusted <= 3) narrative = lowNarr;
        else if (adjusted >= 8) narrative = highNarr;

        userScores[currentIndex] = {
          score: adjusted,
          weight: parseFloat(weight),
          originalInput: i,
          question: question
        };

        narrativeBox.innerHTML = `<p style='margin-top: 20px;'>${narrative}</p>`;
        narrativeBox.style.display = "block";

        if (!selected) {
          selected = true;
          setTimeout(() => {
            nextBtn.style.display = "block";
            nextBtn.textContent = (currentIndex === quizData.length - 1) ? "Show Results" : "Next Question →";
          }, 1500);

          nextBtn.onclick = () => {
            narrativeBox.style.display = "none";
            nextBtn.style.display = "none";
            currentIndex++;
            if (currentIndex < quizData.length) loadQuestion(currentIndex);
            else showFinalResult();
          };
        }
      };
      buttonWrapper.appendChild(btn);
    }
    scale.appendChild(buttonWrapper);
  }
}

function loadQuestion(index) {
  const [q, high, mid, low, w, ...rest] = quizData[index];
  const flipLogic = rest[11]?.toLowerCase() === "false";
  const container = document.getElementById("quiz-question");
  container.innerHTML = `<h2 style="text-align: center; color: var(--understanding); font-family: 'Playfair Display', serif;">${q}</h2>`;

  renderInput(container, flipLogic, w, high, mid, low, q);
}

function showFinalResult() {
  let total = 0, weightTotal = 0;
  userScores.forEach(entry => {
    total += entry.score * entry.weight;
    weightTotal += entry.weight;
  });

  const avg = total / weightTotal;
  let label = "⚠️ Domestic Threat";
  if (avg >= 1.0) label = "🕳️ Accelerationist";
  if (avg >= 1.8) label = "🔥 Militant Mindset";
  if (avg >= 2.5) label = "🛰️ Operational Extremist";
  if (avg >= 3.2) label = "🧨 Extremist-Leaning";
  if (avg >= 3.9) label = "📡 Radicalized";
  if (avg >= 4.8) label = "🛡️ Dogmatic";
  if (avg >= 5.7) label = "🪞 Ideological Echo";
  if (avg >= 6.6) label = "🧭 Tilted";
  if (avg >= 7.5) label = "🪶 Healthy Skeptic";
  if (avg >= 8.8) label = "🦉 Grounded";

  const insightIndex = Math.floor(avg);
  const strategicInsight = insightMessages[insightIndex] || "";

  const insightBox = `
  <div style="
    background-color: #101020;
    border: 2px solid #C89B3C;
    color: #F5F5F5;
    font-family: 'Playfair Display', serif;
    font-size: 1.1rem;
    padding: 24px 28px;
    border-radius: 12px;
    margin-bottom: 32px;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
  ">
    <div style="
      text-transform: uppercase;
      letter-spacing: 1px;
      font-size: 0.85rem;
      font-weight: 600;
      color: #FFD700;
      margin-bottom: 12px;
    ">
      Strategic Insight
    </div>
    <div style="font-family: 'Inter', sans-serif; font-size: 1rem; line-height: 1.6;">
      ${strategicInsight}
    </div>
  </div>`;

  const resultList = userScores.map(entry => {
    return `
      <div style="
        background-color: var(--surface);
        padding: 16px 20px;
        margin-bottom: 12px;
        border-left: 4px solid var(--reliability);
        border-radius: 6px;
        font-family: 'Inter', sans-serif;
        color: var(--text);
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      ">
        <div style="font-weight: 600; margin-bottom: 6px;">${entry.question}</div>
        <div style="font-size: 0.95rem;"><strong>Your Answer:</strong> ${entry.originalInput}</div>
      </div>`;
  }).join("");

  document.getElementById("quiz-container").innerHTML = `
    <h2>Your Strategic Owl Insight</h2>
    <p style="font-size: 1.2rem;">Weighted Score: <strong>${avg.toFixed(2)}</strong></p>
    <p style="font-size: 1.4rem; font-weight: bold; color: var(--understanding);">${label}</p>
    ${insightBox}
    <hr style="margin: 30px 0; border: 1px solid var(--highlight);" />
    <div style="max-width: 700px; margin: 0 auto;">${resultList}</div>
  `;
}

window.addEventListener("DOMContentLoaded", async () => {
  [quizData, insightMessages] = await Promise.all([
    fetchTRUData(),
    fetchInsightMessages()
  ]);
  loadQuestion(currentIndex);
});

function toggleMenu() {
  document.getElementById("navMenu").classList.toggle("show");
}
</script>
</body>
</html>
