<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Virtual Guitar Fretboard</title>
  <style>
    :root {
      --fret-color: #ccc;
      --string-color: #aaa;
      --note-bg: #112240;
      --note-text: #fff;
      --highlight-color: #D4AF37;
    }

    body {
      margin: 0;
      font-family: sans-serif;
      background-color: #0D1B2A;
      color: var(--note-text);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    h1 {
      margin-bottom: 30px;
      font-size: 1.6rem;
      color: var(--highlight-color);
    }

    .fretboard-wrapper {
      overflow-x: auto;
      width: 100%;
      max-width: 100vw;
    }

    .fretboard {
      display: flex;
      flex-direction: column;
      gap: 2px;
      background: transparent;
    }

    .string-row {
      display: grid;
      grid-template-columns: 60px repeat(24, 42px);
    }

    .string-label {
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      background: #1A2B4C;
      color: var(--highlight-color);
    }

    .note-cell {
      border-left: 1px solid var(--fret-color);
      border-bottom: 2px solid var(--string-color);
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--note-bg);
      color: var(--note-text);
      font-size: 0.85rem;
      font-weight: 600;
      position: relative;
      white-space: pre-line;
    }

    .interval-R {
      background-color: #2e7031; /* dim green */
    }

    .interval-M3, .interval-m3 {
      background-color: #3e4c75; /* dim blue */
    }

    .interval-P5 {
      background-color: #704c2e; /* dim brown/orange */
    }

    .interval-M7, .interval-m7 {
      background-color: #553770; /* dim violet */
    }

    .fret-marker {
      position: absolute;
      bottom: 3px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.75rem;
      color: var(--highlight-color);
    }

    select.tuning-select {
      width: 60px;
      background: #1A2B4C;
      color: white;
      border: none;
      padding: 5px;
      font-weight: bold;
    }

    @media (max-width: 768px) {
      .note-cell {
        width: 36px;
        height: 36px;
        font-size: 0.7rem;
      }
    }
  </style>
</head>
<body>
  <h1>Virtual Guitar Fretboard</h1>
  <label style="margin-bottom: 12px;">
    <input type="checkbox" id="accidental-toggle" />
    Use Flat Notes
  </label>
  <label for="chord-select" style="margin: 12px 0;">
    Select Chord or Scale:
    <select id="chord-select">
      <option value="">-- Select --</option>
      <option value="A-major">A Major</option>
      <option value="A-minor">A Minor</option>
      <option value="C-major">C Major</option>
      <option value="C-minor">C Minor</option>
      <option value="E-major">E Major</option>
      <option value="E-minor">E Minor</option>
      <option value="A-blues">A Blues</option>
    </select>
  </label>
  <div id="step-info" style="margin: 8px 0; font-size: 0.9rem; color: #fff;"></div>
  <div class="fretboard-wrapper">
    <div class="fretboard" id="fretboard"></div>
  </div>

  <script>
    const SHARP_NOTES = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
    const FLAT_NOTES  = ['C', 'Db', 'D', 'Eb', 'E', 'F', 'Gb', 'G', 'Ab', 'A', 'Bb', 'B'];
    const standardTuning = ['E', 'B', 'G', 'D', 'A', 'E'];
    const numFrets = 24;

    const CHORD_SCALES = {
      'A-major':  { root: 'A', intervals: [0, 4, 7] },
      'A-minor':  { root: 'A', intervals: [0, 3, 7] },
      'C-major':  { root: 'C', intervals: [0, 4, 7] },
      'C-minor':  { root: 'C', intervals: [0, 3, 7] },
      'E-major':  { root: 'E', intervals: [0, 4, 7] },
      'E-minor':  { root: 'E', intervals: [0, 3, 7] },
      'A-blues':  { root: 'A', intervals: [0, 3, 5, 6, 7, 10] }
    };

    const fretboardEl = document.getElementById("fretboard");

    function createTuningSelect(stringIndex, defaultNote) {
      const useFlats = document.getElementById("accidental-toggle")?.checked;
      const ALL_NOTES = useFlats ? FLAT_NOTES : SHARP_NOTES;

      const select = document.createElement("select");
      select.className = "tuning-select";
      select.dataset.string = stringIndex;

      while (select.firstChild) select.removeChild(select.firstChild);

      ALL_NOTES.forEach(note => {
        const opt = document.createElement("option");
        opt.value = note;
        opt.textContent = note;
        if (note === defaultNote) opt.selected = true;
        select.appendChild(opt);
      });
      select.addEventListener("change", () => {
        standardTuning[stringIndex] = select.value;
        renderFretboard();
      });
      return select;
    }

    function getNoteAt(startNote, fret) {
      const useFlats = document.getElementById("accidental-toggle")?.checked;
      const ALL_NOTES = useFlats ? FLAT_NOTES : SHARP_NOTES;

      const startIndex = ALL_NOTES.indexOf(startNote);
      return ALL_NOTES[(startIndex + fret) % 12];
    }

    function renderFretboard() {
      fretboardEl.innerHTML = "";

      const useFlats = document.getElementById("accidental-toggle")?.checked;
      const scaleSelect = document.getElementById("chord-select");
      const selectedScale = scaleSelect?.value;
      const scaleData = CHORD_SCALES[selectedScale];
      const rootNote = scaleData?.root || null;
      const scaleIntervals = scaleData?.intervals || null;

      const stepInfo = document.getElementById("step-info");
      if (scaleData && rootNote && scaleIntervals) {
        stepInfo.textContent = `Intervals from ${rootNote}: ${scaleIntervals.join(", ")}`;
      } else {
        stepInfo.textContent = "";
      }

      for (let string = 0; string < 6; string++) {
        const tuning = document.querySelector(`select[data-string='${string}']`);
        const tuningNote = tuning ? tuning.value : standardTuning[string];

        const row = document.createElement("div");
        row.className = "string-row";

        const tuningSelect = createTuningSelect(string, tuningNote);
        row.appendChild(tuningSelect);

        for (let fret = 1; fret <= numFrets; fret++) {
          const cell = document.createElement("div");
          cell.className = "note-cell";
          const note = getNoteAt(tuningNote, fret);
          let showNote = true;

          if (scaleIntervals && rootNote) {
            const ALL_NOTES = useFlats ? FLAT_NOTES : SHARP_NOTES;
            const rootIndex = ALL_NOTES.indexOf(rootNote);
            const noteIndex = ALL_NOTES.indexOf(note);
            const semitoneFromRoot = (noteIndex - rootIndex + 12) % 12;
            showNote = scaleIntervals.includes(semitoneFromRoot);
          }

          if (showNote && scaleIntervals && rootNote) {
            const intervalName = {
              0: 'R', 1: 'm2', 2: 'M2', 3: 'm3', 4: 'M3', 5: 'P4',
              6: 'TT', 7: 'P5', 8: 'm6', 9: 'M6', 10: 'm7', 11: 'M7'
            }[semitoneFromRoot];
            cell.textContent = `${note}\n${intervalName}`;
            cell.classList.add(`interval-${intervalName}`);
          } else {
            cell.textContent = showNote ? note : "";
          }

          if ([3, 5, 7, 9, 12, 15, 17, 19, 21, 24].includes(fret)) {
            const dot = document.createElement("div");
            dot.className = "fret-marker";
            dot.textContent = "â€¢";
            cell.appendChild(dot);
          }

          row.appendChild(cell);
        }

        fretboardEl.appendChild(row);
      }
    }

    document.getElementById("accidental-toggle").addEventListener("change", renderFretboard);
    document.getElementById("chord-select").addEventListener("change", renderFretboard);

    renderFretboard();
  </script>
</body>
</html> 
